<!DOCTYPE html><html><head><title>R: Draw a Heat Map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body> <div style='padding: 20pt; border: 2px solid black; text-align:center;'><b>This help topic is for R version 2.2.0. For the corresponding topic in the current version of R, see <a href='https://stat.ethz.ch/R-manual/R-patched/library/stats/html/heatmap.html'>https://stat.ethz.ch/R-manual/R-patched/library/stats/html/heatmap.html</a></b></div><div class="container">

<table style="width: 100%;"><tr><td>heatmap {stats}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='heatmap'> Draw a Heat Map </h2>

<h3>Description</h3>

<p>A heat map is a false color image (basically
<code>image(t(x))</code>) with a dendrogram added to the left side
and to the top.  Typically, reordering of the rows and columns
according to some set of values (row or column means) within the
restrictions imposed by the dendrogram is carried out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap(x, Rowv=NULL, Colv=if(symm)"Rowv" else NULL,
	distfun = dist, hclustfun = hclust,
        reorderfun = function(d,w) reorder(d,w),
        add.expr, symm = FALSE, revC = identical(Colv, "Rowv"),
	scale=c("row", "column", "none"), na.rm = TRUE,
	margins = c(5, 5), ColSideColors, RowSideColors,
	cexRow = 0.2 + 1/log10(nr), cexCol = 0.2 + 1/log10(nc),
	labRow = NULL, labCol = NULL, main = NULL,
        xlab = NULL, ylab = NULL,
        keep.dendro = FALSE, verbose = getOption("verbose"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_:_x">x</code></td>
<td>
<p>numeric matrix of the values to be plotted. </p>
</td></tr>
<tr><td><code id="heatmap_:_Rowv">Rowv</code></td>
<td>
<p>determines if and how the <em>row</em> dendrogram should be
computed and reordered.  Either a <code>dendrogram</code> or a
vector of values used to reorder the row dendrogram or
<code>NA</code> to suppress any row dendrogram (and reordering) or
by default, <code>NULL</code>, see <em>Details</em> below.</p>
</td></tr>
<tr><td><code id="heatmap_:_Colv">Colv</code></td>
<td>
<p>determines if and how the <em>column</em> dendrogram should be
reordered.	Has the same options as the <code>Rowv</code> argument above and
<em>additionally</em> when <code>x</code> is a square matrix, <code>Colv =
      "Rowv"</code> means that columns should be treated identically to the rows.</p>
</td></tr>
<tr><td><code id="heatmap_:_distfun">distfun</code></td>
<td>
<p>function used to compute the distance (dissimilarity)
between both rows and columns.  Defaults to <code>dist</code>.</p>
</td></tr>
<tr><td><code id="heatmap_:_hclustfun">hclustfun</code></td>
<td>
<p>function used to compute the hierarchical clustering
when <code>Rowv</code> or <code>Colv</code> are not dendrograms.  Defaults to
<code>hclust</code>.</p>
</td></tr>
<tr><td><code id="heatmap_:_reorderfun">reorderfun</code></td>
<td>
<p>function(d,w) of dendrogram and weights for
reordering the row and column dendrograms.  The default uses
<code>reorder.dendrogram</code>.</p>
</td></tr>
<tr><td><code id="heatmap_:_add.expr">add.expr</code></td>
<td>
<p>expression that will be evaluated after the call to
<code>image</code>.  Can be used to add components to the plot.</p>
</td></tr>
<tr><td><code id="heatmap_:_symm">symm</code></td>
<td>
<p>logical indicating if <code>x</code> should be treated
<b>symm</b>etrically; can only be true when <code>x</code> is a square matrix.</p>
</td></tr>
<tr><td><code id="heatmap_:_revC">revC</code></td>
<td>
<p>logical indicating if the column order should be
<code>rev</code>ersed for plotting, such that e.g., for the
symmetric case, the symmetry axis is as usual.</p>
</td></tr>
<tr><td><code id="heatmap_:_scale">scale</code></td>
<td>
<p>character indicating if the values should be centered and
scaled in either the row direction or the column direction, or
none.  The default is <code>"row"</code> if <code>symm</code> false, and
<code>"none"</code> otherwise.</p>
</td></tr>
<tr><td><code id="heatmap_:_na.rm">na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code>'s should be removed.</p>
</td></tr>
<tr><td><code id="heatmap_:_margins">margins</code></td>
<td>
<p>numeric vector of length 2 containing the margins
(see <code>par(mar= *)</code>) for column and row names, respectively.</p>
</td></tr>
<tr><td><code id="heatmap_:_ColSideColors">ColSideColors</code></td>
<td>
<p>(optional) character vector of length <code>ncol(x)</code>
containing the color names for a horizontal side bar that may be used to
annotate the columns of <code>x</code>.</p>
</td></tr>
<tr><td><code id="heatmap_:_RowSideColors">RowSideColors</code></td>
<td>
<p>(optional) character vector of length <code>nrow(x)</code>
containing the color names for a vertical side bar that may be used to
annotate the rows of <code>x</code>.</p>
</td></tr>
<tr><td><code id="heatmap_:_cexRow">cexRow</code>, <code id="heatmap_:_cexCol">cexCol</code></td>
<td>
<p>positive numbers, used as <code>cex.axis</code> in
for the row or column axis labeling.  The defaults currently only
use number of rows or columns, respectively.</p>
</td></tr>
<tr><td><code id="heatmap_:_labRow">labRow</code>, <code id="heatmap_:_labCol">labCol</code></td>
<td>
<p>character vectors with row and column labels to
use; these default to <code>rownames(x)</code> or <code>colnames(x)</code>,
respectively.</p>
</td></tr>
<tr><td><code id="heatmap_:_main">main</code>, <code id="heatmap_:_xlab">xlab</code>, <code id="heatmap_:_ylab">ylab</code></td>
<td>
<p>main, x- and y-axis titles; defaults to none.</p>
</td></tr>
<tr><td><code id="heatmap_:_keep.dendro">keep.dendro</code></td>
<td>
<p>logical indicating if the dendrogram(s) should be
kept as part of the result (when <code>Rowv</code> and/or <code>Colv</code> are
not NA).</p>
</td></tr>
<tr><td><code id="heatmap_:_verbose">verbose</code></td>
<td>
<p>logical indicating if information should be printed.</p>
</td></tr>
<tr><td><code id="heatmap_:_...">...</code></td>
<td>
<p>additional arguments passed on to <code>image</code>,
e.g., <code>col</code> specifying the colors.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>If either <code>Rowv</code> or <code>Colv</code> are dendrograms they are honored
(and not reordered).	Otherwise, dendrograms are computed as
<code>dd &lt;- as.dendrogram(hclustfun(distfun(X)))</code> where <code>X</code> is
either <code>x</code> or <code>t(x)</code>.
</p>
<p>If either is a vector (of &ldquo;weights&rdquo;) then the appropriate
dendrogram is reordered according to the supplied values subject to
the constraints imposed by the dendrogram, by <code>reorder(dd,
    Rowv)</code>, in the row case.

If either is missing, as by default, then the ordering of the
corresponding dendrogram is by the mean value of the rows/columns,
i.e., in the case of rows, <code>Rowv &lt;- rowMeans(x, na.rm=na.rm)</code>.

If either is <code>NULL</code>, <em>no reordering</em> will be done for
the corresponding side.
</p>
<p>By default (<code>scale = "row"</code>) the rows are scaled to have mean
zero and standard deviation one.  There is some empirical evidence
from genomic plotting that this is useful.
</p>
<p>The default colors are not pretty.  Consider using enhancements such
as the <span class="pkg">RColorBrewer</span> package,
<a href="http://cran.r-project.org/src/contrib/PACKAGES.html#RColorBrewer">http://cran.r-project.org/src/contrib/PACKAGES.html#RColorBrewer</a>.
</p>


<h3>Value</h3>

<p>Invisibly, a list with components
</p>
<table>
<tr><td><code>rowInd</code></td>
<td>
<p><b>r</b>ow index permutation vector as returned by
<code>order.dendrogram</code>.</p>
</td></tr>
<tr><td><code>colInd</code></td>
<td>
<p><b>c</b>olumn index permutation vector.</p>
</td></tr>
<tr><td><code>Rowv</code></td>
<td>
<p>the row dendrogram; only if input <code>Rowv</code> was not NA
and <code>keep.dendro</code> is true.</p>
</td></tr>
<tr><td><code>Colv</code></td>
<td>
<p>the column dendrogram; only if input <code>Colv</code> was not NA
and <code>keep.dendro</code> is true.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Unless <code>Rowv = NA</code> (or <code>Colw = NA</code>), the original rows and
columns are reordered <em>in any case</em> to match the dendrogram,
e.g., the rows by <code>order.dendrogram(Rowv)</code> where
<code>Rowv</code> is the (possibly <code>reorder()</code>ed) row
dendrogram.
</p>
<p><code>heatmap()</code> uses <code>layout</code> and draws the
<code>image</code> in the lower right corner of a 2x2 layout.
Consequentially, it can <b>not</b> be used in a multi column/row
layout, i.e., when <code>par(mfrow= *)</code> or <code>(mfcol= *)</code>
has been called.
</p>


<h3>Author(s)</h3>

<p>Andy Liaw, original; R. Gentleman, M. Maechler, W. Huber, revisions.</p>


<h3>See Also</h3>

<p><code>image</code>, <code>hclust</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)
x  &lt;- as.matrix(mtcars)
rc &lt;- rainbow(nrow(x), start=0, end=.3)
cc &lt;- rainbow(ncol(x), start=0, end=.3)
hv &lt;- heatmap(x, col = cm.colors(256), scale="column",
	      RowSideColors = rc, ColSideColors = cc, margin=c(5,10),
	      xlab = "specification variables", ylab= "Car Models",
	      main = "heatmap(&lt;Mtcars data&gt;, ..., scale = \"column\")")
str(hv) # the two re-ordering index vectors

## no column dendrogram (nor reordering) at all:
heatmap(x, Colv = NA, col = cm.colors(256), scale="column",
	RowSideColors = rc, margin=c(5,10),
	xlab = "specification variables", ylab= "Car Models",
	main = "heatmap(&lt;Mtcars data&gt;, ..., scale = \"column\")")

## "no nothing"
heatmap(x, Rowv = NA, Colv = NA, scale="column",
	main = "heatmap(*, NA, NA) ~= image(t(x))")


round(Ca &lt;- cor(attitude), 2)
symnum(Ca) # simple graphic
heatmap(Ca,	        symm = TRUE, margin=c(6,6))# with reorder()
heatmap(Ca, Rowv=FALSE, symm = TRUE, margin=c(6,6))# _NO_ reorder()

## For variable clustering, rather use distance based on cor():
symnum( cU &lt;- cor(USJudgeRatings) )

hU &lt;- heatmap(cU, Rowv = FALSE, symm = TRUE, col = topo.colors(16),
	     distfun = function(c) as.dist(1 - c), keep.dendro = TRUE)
## The Correlation matrix with same reordering:
round(100 * cU[hU[[1]], hU[[2]]])
## The column dendrogram:
str(hU$Colv)
</code></pre>

<hr /><div style="text-align: center;">[<a href='/r-help/2.2.0/00index.html'>Package <em>stats</em> version 2.2.0</a> ]</div>
</div>
</body></html>
