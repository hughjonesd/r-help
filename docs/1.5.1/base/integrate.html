<!DOCTYPE html><html><head><title>R: Integration of One-Dimensional Functions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body> <div style='padding: 20pt; border: 2px solid black; text-align:center;'><b>This help topic is for R version 1.5.1. For the corresponding topic in the current version of R, see <a href='https://stat.ethz.ch/R-manual/R-patched/library/base/html/integrate.html'>https://stat.ethz.ch/R-manual/R-patched/library/base/html/integrate.html</a></b></div><div class="container">

<table style="width: 100%;"><tr><td>integrate {base}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='integrate'>Integration of One-Dimensional Functions</h2>

<h3>Description</h3>

<p>Adaptive quadrature of functions of one variable over a finite or
infinite interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate(f, lower, upper, subdivisions=100,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_:_f">f</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> function taking a numeric first argument and returning
a numeric vector the same length. Returning a non-finite element will
generate an error.</p>
</td></tr>
<tr><td><code id="integrate_:_lower">lower</code>, <code id="integrate_:_upper">upper</code></td>
<td>
<p>The limits of integration. Can be infinite.</p>
</td></tr>
<tr><td><code id="integrate_:_subdivisions">subdivisions</code></td>
<td>
<p>the maximum number of subintervals.</p>
</td></tr>
<tr><td><code id="integrate_:_rel.tol">rel.tol</code></td>
<td>
<p>relative accuracy requested.</p>
</td></tr>
<tr><td><code id="integrate_:_abs.tol">abs.tol</code></td>
<td>
<p>absolute accuracy requested.</p>
</td></tr>
<tr><td><code id="integrate_:_stop.on.error">stop.on.error</code></td>
<td>
<p>logical. If true (the default) an error stops the
function.  If false some errors will give a result with a warning in
the <code>message</code> component.</p>
</td></tr>
<tr><td><code id="integrate_:_keep.xy">keep.xy</code></td>
<td>
<p>unused. For compatibility with S.</p>
</td></tr>
<tr><td><code id="integrate_:_aux">aux</code></td>
<td>
<p>unused. For compatibility with S.</p>
</td></tr>
<tr><td><code id="integrate_:_...">...</code></td>
<td>
<p>additional arguments to be passes to <code>f</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If one or both limits are infinite, the
infinite range is mapped onto a finite interval.
</p>
<p>For a finite interval, globally adaptive interval subdivision is used
in connection with extrapolation by the Epsilon algorithm.
</p>
<p><code>rel.tol</code> cannot be less than <code>max(50*.Machine$double.eps,
    0.5e-28)</code> if <code>abs.tol &lt;= 0</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"integrate"</code> with components
</p>
<table>
<tr><td><code>value</code></td>
<td>
<p>the final estimate of the integral.</p>
</td></tr>
<tr><td><code>abs.error</code></td>
<td>
<p>estimate of the modulus of the absolute error.</p>
</td></tr>
<tr><td><code>subdivisions</code></td>
<td>
<p>the number of subintervals produced in the
subdivision process.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p><code>"OK"</code> or a character string giving the error message.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Based on QUADPACK routines <code>dqags</code> and <code>dqagi</code> by
R. Piessens and E. deDoncker-Kapenga, available from Netlib.
</p>
<p>See<br />
R. Piessens, E. deDoncker-Kapenga, C. Uberhuber, D. Kahaner (1983)
<em>Quadpack: a Subroutine Package for Automatic Integration</em>;
Springer Verlag.
</p>


<h3>See Also</h3>

<p>The function <code>adapt</code> in the <code>adapt</code> package on
CRAN, for multivariate integration.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>integrate(dnorm, -1.96, 1.96)
integrate(dnorm, -Inf, Inf)


## a slowly-convergent integral
integrand &lt;- function(x) {1/((x+1)*sqrt(x))}
integrate(integrand, lower = 0, upper = Inf)

integrate(integrand, lower = 0, upper = 10)
integrate(integrand, lower = 0, upper = 100000)
integrate(integrand, lower = 0, upper = 1000000, stop.on.error = FALSE)

try(integrate(function(x) 2, 0, 1))  ## no vectorizable function
integrate(function(x) rep(2, length(x)), 0, 1)  ## correct
</code></pre>

<hr /><div style="text-align: center;">[<a href='/r-help/1.5.1/00index.html'>Package <em>base</em> version 1.5.1</a> ]</div>
</div>
</body></html>
