<!DOCTYPE html><html><head><title>R: Fourfold Plots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body> <div style='padding: 20pt; border: 2px solid black; text-align:center;'><b>This help topic is for R version 2.12.0. For the corresponding topic in the current version of R, see <a href='https://stat.ethz.ch/R-manual/R-patched/library/graphics/html/fourfoldplot.html'>https://stat.ethz.ch/R-manual/R-patched/library/graphics/html/fourfoldplot.html</a></b></div><div class="container">

<table style="width: 100%;"><tr><td>fourfoldplot {graphics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='fourfoldplot'>Fourfold Plots</h2>

<h3>Description</h3>

<p>Creates a fourfold display of a 2 by 2 by <code class="reqn">k</code> contingency table on
the current graphics device, allowing for the visual inspection of the
association between two dichotomous variables in one or several
populations (strata).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fourfoldplot(x, color = c("#99CCFF", "#6699CC"),
             conf.level = 0.95,
             std = c("margins", "ind.max", "all.max"),
             margin = c(1, 2), space = 0.2, main = NULL,
             mfrow = NULL, mfcol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fourfoldplot_:_x">x</code></td>
<td>
<p>a 2 by 2 by <code class="reqn">k</code> contingency table in array form, or as a
2 by 2 matrix if <code class="reqn">k</code> is 1.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_color">color</code></td>
<td>
<p>a vector of length 2 specifying the colors to use for the
smaller and larger diagonals of each 2 by 2 table.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_conf.level">conf.level</code></td>
<td>
<p>confidence level used for the confidence rings on
the odds ratios.  Must be a single nonnegative number less than 1;
if set to 0, confidence rings are suppressed.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_std">std</code></td>
<td>
<p>a character string specifying how to standardize the table.
Must be one of <code>"margins"</code>, <code>"ind.max"</code>, or
<code>"all.max"</code>, and can be abbreviated by the initial letter.
If set to <code>"margins"</code>, each 2 by 2 table is standardized to
equate the margins specified by <code>margin</code> while preserving the
odds ratio.  If <code>"ind.max"</code> or <code>"all.max"</code>, the tables are
either individually or simultaneously standardized to a maximal cell
frequency of 1.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_margin">margin</code></td>
<td>
<p>a numeric vector with the margins to equate.  Must be
one of <code>1</code>, <code>2</code>, or <code>c(1, 2)</code> (the default), which
corresponds to standardizing the row, column, or both margins in
each 2 by 2 table.
Only used if <code>std</code> equals <code>"margins"</code>.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_space">space</code></td>
<td>
<p>the amount of space (as a fraction of the maximal radius
of the quarter circles) used for the row and column lebals.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_main">main</code></td>
<td>
<p>character string for the fourfold title.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_mfrow">mfrow</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by rows.</p>
</td></tr>
<tr><td><code id="fourfoldplot_:_mfcol">mfcol</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fourfold display is designed for the display of 2 by 2 by <code class="reqn">k</code>
tables.
</p>
<p>Following suitable standardization, the cell frequencies
<code class="reqn">f_{ij}</code> of each 2 by 2 table are shown as a quarter
circle whose radius is proportional to
<code class="reqn">\sqrt{f_{ij}}</code> so that its area is proportional to
the cell frequency.  An association (odds ratio different from 1)
between the binary row and column variables is indicated by the
tendency of diagonally opposite cells in one direction to differ in
size from those in the other direction; color is used to show this
direction.  Confidence rings for the odds ratio allow a visual test of
the null of no association; the rings for adjacent quadrants overlap
if and only if the observed counts are consistent with the null hypothesis.
</p>
<p>Typically, the number <code class="reqn">k</code> corresponds to the number of levels of a
stratifying variable, and it is of interest to see whether the
association is homogeneous across strata.  The fourfold display
visualizes the pattern of association.  Note that the confidence rings
for the individual odds ratios are not adjusted for multiple testing.
</p>


<h3>References</h3>

<p>Friendly, M. (1994).
A fourfold display for 2 by 2 by <code class="reqn">k</code> tables.
Technical Report 217, York University, Psychology Department.
<a href="http://www.math.yorku.ca/SCS/Papers/4fold/4fold.ps.gz">http://www.math.yorku.ca/SCS/Papers/4fold/4fold.ps.gz</a>
</p>


<h3>See Also</h3>

<p><code>mosaicplot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Use the Berkeley admission data as in Friendly (1995).
x &lt;- aperm(UCBAdmissions, c(2, 1, 3))
dimnames(x)[[2]] &lt;- c("Yes", "No")
names(dimnames(x)) &lt;- c("Sex", "Admit?", "Department")
stats::ftable(x)

## Fourfold display of data aggregated over departments, with
## frequencies standardized to equate the margins for admission
## and sex.
## Figure 1 in Friendly (1994).
fourfoldplot(margin.table(x, c(1, 2)))

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission and sex.
## Figure 2 in Friendly (1994).
fourfoldplot(x)

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission. but not
## for sex.
## Figure 3 in Friendly (1994).
fourfoldplot(x, margin = 2)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>graphics</em> version 2.12.0 ]</div>
</div>
</body></html>
