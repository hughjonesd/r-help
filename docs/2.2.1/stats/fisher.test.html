<!DOCTYPE html><html><head><title>R: Fisher's Exact Test for Count Data</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body> <div style='padding: 20pt; border: 2px solid black; text-align:center;'><b>This help topic is for R version 2.2.1. For the current version of R, try <a href='https://stat.ethz.ch/R-manual/R-patched/library/stats/html/fisher.test.html'>https://stat.ethz.ch/R-manual/R-patched/library/stats/html/fisher.test.html</a></b></div><div class="container"><main>

<table style="width: 100%;"><tr><td>fisher.test {stats}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fisher's Exact Test for Count Data</h2>

<h3>Description</h3>

<p>Performs Fisher's exact test for testing the null of independence of
rows and columns in a contingency table with fixed marginals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher.test(x, y = NULL, workspace = 200000, hybrid = FALSE,
            control = list(), or = 1, alternative = "two.sided",
            conf.int = TRUE, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x">x</code></td>
<td>
<p>either a two-dimensional contingency table in matrix form,
or a factor object.</p>
</td></tr>
<tr><td><code id="y">y</code></td>
<td>
<p>a factor object; ignored if <code>x</code> is a matrix.</p>
</td></tr>
<tr><td><code id="workspace">workspace</code></td>
<td>
<p>an integer specifying the size of the workspace
used in the network algorithm.  In units of 4 bytes.</p>
</td></tr>
<tr><td><code id="hybrid">hybrid</code></td>
<td>
<p>a logical. Only used for larger than 2 by 2 tables, in
which cases it indicated whether the exact probabilities
(default) or a hybrid approximation thereof should be computed.
See Details.</p>
</td></tr>
<tr><td><code id="control">control</code></td>
<td>
<p>a list with named components for low level algorithm
control.  At present the only one used is <code>"mult"</code>, a positive
integer <code class="reqn">&gt;= 2</code> with default 30.  This says how many times as
much space should be allocated to paths as to keys: see file
&lsquo;<span class="file">fexact.c</span>&rsquo; in the sources of this package.</p>
</td></tr>
<tr><td><code id="or">or</code></td>
<td>
<p>the hypothesized odds ratio.  Only used in the 2 by 2 case.</p>
</td></tr>
<tr><td><code id="alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be
one of <code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>.
You can specify just the initial letter.  Only used in the 2 by
2 case.</p>
</td></tr>
<tr><td><code id="conf.int">conf.int</code></td>
<td>
<p>logical indicating if a confidence interval should be
computed (and returned).</p>
</td></tr>
<tr><td><code id="conf.level">conf.level</code></td>
<td>
<p>confidence level for the returned confidence
interval.  Only used in the 2 by 2 case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is a matrix, it is taken as a two-dimensional contingency
table, and hence its entries should be nonnegative integers.
Otherwise, both <code>x</code> and <code>y</code> must be vectors of the same
length.  Incomplete cases are removed, the vectors are coerced into
factor objects, and the contingency table is computed from these.
</p>
<p>In the one-sided 2 by 2 cases (and where <code>or</code> is specified),
p-values are obtained directly using the hypergeometric
distribution. Otherwise, computations are based on a C version of the
FORTRAN subroutine FEXACT which implements the network developed by
Mehta and Patel (1986) and improved by Clarkson, Fan &amp; Joe (1993).
The FORTRAN code can be obtained from
<a href="http://www.netlib.org/toms/643">http://www.netlib.org/toms/643</a>.  Note this fails (with an error
message) when the entries of the table are too large.  (It transposes
the table if necessary so it has no more rows than columns.  One
constraint is that the product of the row marginals be less than
<code class="reqn">2^{31} - 1</code>.)
</p>
<p>In the 2 by 2 case, the null of conditional independence is equivalent
to the hypothesis that the odds ratio equals one.  &lsquo;Exact&rsquo; inference can
be based on observing that in general, given all marginal totals
fixed, the first element of the contingency table has a non-central
hypergeometric distribution with non-centrality parameter given by the
odds ratio (Fisher, 1935).  The alternative for a one-sided test is
based on the odds ratio, so <code>alternative = "greater"</code> is a test
of the odds ratio being bigger than <code>or</code>.
</p>
<p>Two-sided tests are based on the probabilities of the tables, and take
as &lsquo;more extreme&rsquo; all tables with probabilities less than or
equal to that of the observed table, the p-value being the sum of such
probabilities.
</p>
<p>For larger then 2 by 2 tables and <code>hybrid = TRUE</code>, asymptotic
chi-squared probabilities are only used if the &ldquo;Cochran
conditions&rdquo; are satisfied, that is if no cell has count zero, and
more than 80% of the cells have counts at least 5.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the odds ratio.
Only present in the 2 by 2 case.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>an estimate of the odds ratio.  Note that the
<em>conditional</em> Maximum Likelihood Estimate (MLE) rather than the
unconditional MLE (the sample odds ratio) is used.
Only present in the 2 by 2 case.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the odds ratio under the null, <code>or</code>.
Only present in the 2 by 2 case.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative
hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the character string
<code>"Fisher's Exact Test for Count Data"</code>.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Agresti, A. (1990).
<em>Categorical data analysis</em>.
New York: Wiley.
Pages 59&ndash;66.
</p>
<p>Fisher, R. A. (1935).
The logic of inductive inference.
<em>Journal of the Royal Statistical Society Series A</em> <b>98</b>,
39&ndash;54.
</p>
<p>Fisher, R. A. (1950).
<em>Statistical Methods for Research Workers.</em>  Oliver &amp; Boyd.
</p>
<p>Fisher, R. A. (1962).
Confidence limits for a cross-product ratio.
<em>Australian Journal of Statistics</em> <b>4</b>, 41.
</p>
<p>Cyrus R. Mehta and Nitin R. Patel (1986).
Algorithm 643. FEXACT: A Fortran subroutine for Fisher's exact test
on unordered <code class="reqn">r*c</code> contingency tables.
<em>ACM Transactions on Mathematical Software</em>, <b>12</b>,
154&ndash;161.
</p>
<p>Douglas B. Clarkson, Yuan-an Fan and Harry Joe (1993).
A Remark on Algorithm 643: FEXACT: An Algorithm for Performing
Fisher's Exact Test in <code class="reqn">r \times c</code> Contingency Tables.
<em>ACM Transactions on Mathematical Software</em>, <b>19</b>,
484&ndash;488.
</p>


<h3>See Also</h3>

<p><code>chisq.test</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Agresti (1990), p. 61f, Fisher's Tea Drinker
## A British woman claimed to be able to distinguish whether milk or
##  tea was added to the cup first.  To test, she was given 8 cups of
##  tea, in four of which milk was added first.  The null hypothesis
##  is that there is no association between the true order of pouring
##  and the women's guess, the alternative that there is a positive
##  association (that the odds ratio is greater than 1).
TeaTasting &lt;-
matrix(c(3, 1, 1, 3),
       nr = 2,
       dimnames = list(Guess = c("Milk", "Tea"),
                       Truth = c("Milk", "Tea")))
fisher.test(TeaTasting, alternative = "greater")
## =&gt; p=0.2429, association could not be established

## Fisher (1950, 1962), Convictions of like-sex twins in criminals
Convictions &lt;-
matrix(c(2, 10, 15, 3),
       nr = 2,
       dimnames =
       list(c("Dizygotic", "Monozygotic"),
            c("Convicted", "Not convicted")))
Convictions
fisher.test(Convictions, alternative = "less")
fisher.test(Convictions, conf.int = FALSE)
fisher.test(Convictions, conf.level = 0.95)$conf.int
fisher.test(Convictions, conf.level = 0.99)$conf.int
</code></pre>

<hr /><div style="text-align: center;">[<a href='/r-help/2.2.1/00index.html'>Package <em>stats</em> version 2.2.1</a> ]</div></main>

</div>
</body></html>
