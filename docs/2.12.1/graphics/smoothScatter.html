<!DOCTYPE html><html><head><title>R: Scatterplots with Smoothed Densities Color Representation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body> <div style='padding: 20pt; border: 2px solid black; text-align:center;'><b>This help topic is for R version 2.12.1. For the corresponding topic in the current version of R, see <a href='https://stat.ethz.ch/R-manual/R-patched/library/graphics/html/smoothScatter.html'>https://stat.ethz.ch/R-manual/R-patched/library/graphics/html/smoothScatter.html</a></b></div><div class="container">

<table style="width: 100%;"><tr><td>smoothScatter {graphics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='smoothScatter'>Scatterplots with Smoothed Densities Color Representation</h2>

<h3>Description</h3>

<p><code>smoothScatter</code> produces a smoothed color density
representation of the scatterplot, obtained through a kernel
density estimate. <code>densCols</code> produces a vector containing
colors which encode the local densities at each point in a
scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothScatter(x, y = NULL, nbin = 128, bandwidth,
              colramp = colorRampPalette(c("white", blues9)),
              nrpoints = 100, pch = ".", cex = 1, col = "black",
              transformation = function(x) x^.25,
              postPlotHook = box,
              xlab = NULL, ylab = NULL, xlim, ylim,
              xaxs = par("xaxs"), yaxs = par("yaxs"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothScatter_:_x">x</code>, <code id="smoothScatter_:_y">y</code></td>
<td>
<p>the <code>x</code> and <code>y</code> arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function <code>xy.coords</code>
for details.  If supplied separately, they must be of the same length.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_nbin">nbin</code></td>
<td>
<p>numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
<code>gridsize</code> in <code>bkde2D()</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_bandwidth">bandwidth</code></td>
<td>
<p>numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. <code>bandwidth</code>
is subsequently passed to function
<code>bkde2D</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_colramp">colramp</code></td>
<td>
<p>function accepting an integer <code>n</code> as an argument and
returning <code>n</code> colors.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_nrpoints">nrpoints</code></td>
<td>
<p>number of points to be superimposed on the density
image.  The first <code>nrpoints</code> points from those areas of lowest
regional densities will be plotted.  Adding points to the plot
allows for the identification of outliers.  If all points are to be
plotted, choose <code>nrpoints = Inf</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_pch">pch</code>, <code id="smoothScatter_:_cex">cex</code>, <code id="smoothScatter_:_col">col</code></td>
<td>
<p>arguments passed to <code>points</code>,
when <code>nrpoints &gt; 0</code>: point symbol, character expansion factor
and color, see also <code>par</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_transformation">transformation</code></td>
<td>
<p>function mapping the density scale to the color scale.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_postPlotHook">postPlotHook</code></td>
<td>
<p>either <code>NULL</code> or a function which will be
called (with no arguments) after <code>image</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_xlab">xlab</code>, <code id="smoothScatter_:_ylab">ylab</code></td>
<td>
<p>character strings to be used as axis labels, passed
to <code>image</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_xlim">xlim</code>, <code id="smoothScatter_:_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2 specifying axis limits.</p>
</td></tr>
<tr><td><code id="smoothScatter_:_xaxs">xaxs</code>, <code id="smoothScatter_:_yaxs">yaxs</code>, <code id="smoothScatter_:_...">...</code></td>
<td>
<p>further arguments, passed to <code>image</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>smoothScatter</code> produces a smoothed version of a scatter plot.
Two dimensional (kernel density) smoothing is performed by
<code>bkde2D</code> from package <span class="pkg">KernSmooth</span>.
See the examples for how to use this function together with
<code>pairs</code>.
</p>


<h3>Author(s)</h3>

<p>Florian Hahne at FHCRC, originally</p>


<h3>See Also</h3>

<p><code>bkde2D</code> from package <span class="pkg">KernSmooth</span>;
<code>densCols</code> which uses the same smoothing computations and
<code>blues9</code> in package <span class="pkg">grDevices</span>.
</p>
<p><code>scatter.smooth</code> adds a <code>loess</code>
regression smoother to a scatter plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## A largish data set
  n &lt;- 10000
  x1  &lt;- matrix(rnorm(n), ncol=2)
  x2  &lt;- matrix(rnorm(n, mean=3, sd=1.5), ncol=2)
  x   &lt;- rbind(x1,x2)

  oldpar &lt;- par(mfrow=c(2,2))
  smoothScatter(x, nrpoints=0)
  smoothScatter(x)

  ## a different color scheme:
  Lab.palette &lt;- colorRampPalette(c("blue", "orange", "red"), space = "Lab")
  smoothScatter(x, colramp = Lab.palette)

  ## somewhat similar, using identical smoothing computations,
  ## but considerably *less* efficient for really large data:
  plot(x, col = densCols(x), pch=20)

  ## use with pairs:
  par(mfrow=c(1,1))
  y &lt;- matrix(rnorm(40000), ncol=4) + 3*rnorm(10000)
  y[, c(2,4)] &lt;-  -y[, c(2,4)]
  pairs(y, panel = function(...) smoothScatter(..., nrpoints=0, add=TRUE))

  par(oldpar)
</code></pre>

<hr /><div style="text-align: center;">[<a href='/r-help/2.12.1/00index.html'>Package <em>graphics</em> version 2.12.1</a> ]</div>
</div>
</body></html>
